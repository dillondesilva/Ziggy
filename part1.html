<!doctype html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8" />
    <title>Happy Zig</title>
    <script src="//cdn.jsdelivr.net/phaser/2.2.2/phaser.min.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>
<div style="text-align:center;">
<script type="text/javascript">
    var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update});;

    function preload ()
    {
        this.load.image('player', 'assets/sprite.svg');
        this.load.image('background', 'bg_one.svg');
        this.load.image('badguy-A', 'assets/badguy.svg');
        this.load.image('explosion', 'assets/explosion.svg');
    }
    var player;
    var badguyA;

    var spinning = false;

    function create ()
    {
        game.physics.startSystem(Phaser.Physics.ARCADE);
        
        this.add.image(0, 0, 'background');
        badguyA = game.add.sprite(400, 100, 'badguy-A');
        player = game.add.sprite(400, 500, 'player');

        player.anchor.setTo(0.5, 0.5);
        enemies = game.add.group();
        
        game.physics.enable( [badguyA, player], Phaser.Physics.ARCADE);

        badguyA.body.gravity.y = 300;

        game.time.events.loop(Phaser.Timer.HALF * 5, createEnemy, this);
    }

    function update ()
    {
        cursors = this.input.keyboard.createCursorKeys();

        if (cursors.left.isDown) {
            player.x -= 10;
        } else if (cursors.right.isDown) {
            player.x += 10;
        } else if (cursors.up.isDown) {
            player.y -= 10;
        } else if (cursors.down.isDown) {
            player.y += 10;
        }

        if (spinning) {
            player.angle += 1;
        }

        game.physics.arcade.overlap(player, enemies, playerDeath, null, this);
    }

    function playerDeath() {
        console.log('hit');
        player.loadTexture('explosion', 0);
        spinning = true;
    }

    function createEnemy () {
    // Add our sprite here with a random x co-ordinate
    var enemy = game.add.sprite(Math.floor(Math.random() * 750, 10), -60, 'badguy-A');

    // Activate the physics system and set gravity on it to 250
    game.physics.arcade.enable(enemy);
    enemy.body.gravity.y = 250;
    enemy.anchor.setTo(0.5, 0.5);
    enemy.checkWorldBounds = true;
    enemy.outOfBoundsKill = true;

    enemies.add(enemy);
    }

</script>
</div>

</body>
</html>